# -*- coding: utf-8 -*-
"""EDA MiBici.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1GlEczc1xrR4VW9-VFL7xajgSIArtXpIh

## Downloading datasets
"""

urls = [
    "https://www.mibici.net/site/assets/files/1200/datos_abiertos_2018_01.csv",
    "https://www.mibici.net/site/assets/files/1201/datos_abiertos_2018_02.csv",
    "https://www.mibici.net/site/assets/files/1202/datos_abiertos_2018_03.csv",
    "https://www.mibici.net/site/assets/files/1203/datos_abiertos_2018_04.csv",
    "https://www.mibici.net/site/assets/files/1204/datos_abiertos_2018_05.csv",
    "https://www.mibici.net/site/assets/files/1205/datos_abiertos_2018_06.csv",
    "https://www.mibici.net/site/assets/files/1206/datos_abiertos_2018_07.csv",
    "https://www.mibici.net/site/assets/files/1207/datos_abiertos_2018_08.csv",
    "https://www.mibici.net/site/assets/files/1208/datos_abiertos_2018_09.csv",
    "https://www.mibici.net/site/assets/files/1209/datos_abiertos_2018_10.csv",
    "https://www.mibici.net/site/assets/files/1210/datos_abiertos_2018_11.csv",
    "https://www.mibici.net/site/assets/files/1211/datos_abiertos_2018_12.csv",
    "https://www.mibici.net/site/assets/files/1214/datos_abiertos_2019_01.csv",
    "https://www.mibici.net/site/assets/files/1217/datos_abiertos_2019_02.csv",
    "https://www.mibici.net/site/assets/files/1218/datos_abiertos_2019_03.csv",
    "https://www.mibici.net/site/assets/files/1219/datos_abiertos_2019_04.csv",
    "https://www.mibici.net/site/assets/files/1220/datos_abiertos_2019_05.csv",
    "https://www.mibici.net/site/assets/files/1221/datos_abiertos_2019_06.csv",
    "https://www.mibici.net/site/assets/files/1222/datos_abiertos_2019_07.csv",
    "https://www.mibici.net/site/assets/files/1223/datos_abiertos_2019_08.csv",
    "https://www.mibici.net/site/assets/files/1224/datos_abiertos_2019_09.csv",
    "https://www.mibici.net/site/assets/files/1225/datos_abiertos_2019_10.csv",
    "https://www.mibici.net/site/assets/files/1227/datos_abiertos_2019_11.csv",
    "https://www.mibici.net/site/assets/files/1228/datos_abiertos_2019_12.csv"
]

for url in urls:
    !curl -O "$url"

import glob
filenames = glob.glob("*.csv")

import pandas as pd
combined_csv = pd.concat([pd.read_csv(f, engine="python") for f in filenames])
combined_csv.to_csv("datos.csv", index=False)

import os
for f in filenames:
    os.remove(f)

df = pd.read_csv('datos.csv')
df = df.rename(columns={"A�o_de_nacimiento": "Anio_de_nacimiento"})
